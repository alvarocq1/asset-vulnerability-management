from gvm.connections import TLSConnection
from gvm.protocols.gmp import Gmp
from gvm.transforms import EtreeCheckCommandTransform

def main():
    # Conectar a OpenVAS usando TLSConnection
    connection = TLSConnection(hostname='192.168.1.36', port=9390)  # Cambia '192.168.1.36' por la IP de tu servidor OpenVAS
    transform = EtreeCheckCommandTransform()
    print("Connecting to OpenVAS...")
    with Gmp(connection=connection, transform=transform) as gmp:
        print("Authenticating...")
        gmp.authenticate(username="admin", password="9133101d-303a-4b10-8c8a-9c9c6c7142d0")  # Cambia las credenciales según corresponda
        print("Authenticated successfully!")
        # Aquí puedes añadir más comandos para interactuar con GVM
        # Ejemplo: obtener la versión de GVM
        version = gmp.get_version()
        print(f"GVM version: {version}")

if __name__ == "__main__":
    main()
