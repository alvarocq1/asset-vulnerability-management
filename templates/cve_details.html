{% extends "base.html" %}

{% block title %}Detalles de la Vulnerabilidad{% endblock %}

{% block content %}
    <div class="container mt-5">
        <h1>Detalles de la Vulnerabilidad</h1>
        {% if details %}
            <div class="card">
                <div class="card-body">
                    <p><strong>Name:</strong> {{ details[1] }}</p>
                    <p><strong>Host:</strong> {{ details[2] }}</p>
                    <p><strong>Port:</strong> {{ details[3] }}</p>
                    <p><strong>CVSS:</strong> {{ details[4] }}</p>
                    <p><strong>CVSS Type:</strong> {{ details[8] }}</p>
                    <p><strong>CVSS Vector:</strong> 
                        {% if details[9] %}
                            {% for vector in details[9].split('/') %}
                                <span class="badge badge-info">{{ vector }}</span>
                            {% endfor %}
                        {% else %}
                            N/A
                        {% endif %}
                    </p>
                    <p><strong>CVES:</strong> {{ details[6] }}</p>
                    <p><strong>Correlation Risk:</strong> {{ '%.2f' | format(details[10]) }}</p>
                    <p><strong>Exploitability:</strong> {{ details[11] }}</p>
                    <p><strong>QOD:</strong> {{ details[5] }}</p>
                    <p><strong>Solution Type:</strong> {{ details[7] }}</p>
                    <div class="bg-custom text-white p-3 mt-3 rounded">
                        <h5>Solution</h5>
                        <pre>{{ details[13] }}</pre>
                    </div>
                    <div class="bg-custom text-white p-3 mt-3 rounded">
                        <h5>Description</h5>
                        <pre>{{ details[12] }}</pre>
                    </div>
                </div>
            </div>
        {% else %}
            <p>No details available for this vulnerability.</p>
        {% endif %}
        <br>
        <a class="btn btn-primary" href="{{ url_for('analysis') }}">Volver a los CVEs</a>
    </div>
{% endblock %}
