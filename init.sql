CREATE TABLE IF NOT EXISTS assets (
    ip_address VARCHAR(15) PRIMARY KEY,
    os VARCHAR(255),
    hostname VARCHAR(255)
);

CREATE TABLE IF NOT EXISTS scan_tasks (
    task_id VARCHAR(36) PRIMARY KEY,
    ip_address VARCHAR(15),
    FOREIGN KEY (ip_address) REFERENCES assets(ip_address)
);

CREATE TABLE IF NOT EXISTS scan_results (
    result_id VARCHAR(255) PRIMARY KEY,
    name TEXT,
    host VARCHAR(20),
    port VARCHAR(20),
    cvss FLOAT,
    qod TEXT,
    nvt_oid VARCHAR(50),
    nvt_family TEXT,
    cve VARCHAR(30),
    solution_type TEXT,
    cvss_type VARCHAR(20),
    cvss_vector VARCHAR(50),
    correlation_risk FLOAT,
    exploitability VARCHAR(1)
);


CREATE TABLE IF NOT EXISTS scan_metadata (
    scan_id SERIAL PRIMARY KEY,
    scan_time TIMESTAMP NOT NULL
);

CREATE TABLE scan_times (
    ip_address VARCHAR(15) PRIMARY KEY,
    start_time TIMESTAMP,
    end_time TIMESTAMP
);
