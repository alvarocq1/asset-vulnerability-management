import requests
import time

# Configura tu clave API y la URL base de la NVD
api_key = 'c54455ca-28f6-4222-88c3-facda15ed7b6'
base_url = 'https://services.nvd.nist.gov/rest/json/cves/2.0'

# Define los parámetros de la solicitud
params = {
    'resultsPerPage': 2000,  # Ajusta el número de resultados por página
    'startIndex': 0
}

headers = {'apiKey': api_key}

# Inicializa contadores
total_vulnerabilities = 0
total_cves = 0

# Obtener totalResults al principio
try:
    response = requests.get(base_url, headers=headers, params=params)
    response.raise_for_status()
    data = response.json()
    total_results = data['totalResults']
    print(f"Número total de resultados: {total_results}")
except requests.exceptions.RequestException as err:
    print(f"Error durante la solicitud: {err}")
    exit()